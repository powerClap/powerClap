This was written from troyFront branch!